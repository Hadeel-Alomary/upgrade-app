<div class="marketwatch" [class.hide-toolbar]="!isToolbarShown()" [class.hide-name-delyed-annotation]="hideNameColumnDelayedAnnotation()">

  <div>
    <box-title *ngIf="isTitleShown()" [title]="title" [autoLink]="autoLink" (outputAutoLink)="autoLink = $event" (close)="onClose()" (outputToggleMaximize)="onToggleMaximize()"></box-title>


    <div *ngIf="!isVisitor()" class="box-toolbar iphone-allow-scrolling" [style.height]="toolbarHeight"
         explain [title]="'اضافة شركات إلى لائحة الأسهم'" [content]="'اكتب اسم الشركة أو رمزها وسيتم اضافتها إلى لائحة الأسهم'"
         [placement]="'bottom'" [(show)]="displayWatchlistTooltip">

      <div class="box-toolbar-child">
        <watchlist-selector [watchlist]="watchlist" (outputWatchlist)="onSelectingWatchlist($event)"></watchlist-selector>
      </div>

      <div *ngIf="isDesktop() &&!isGlobalPredefinedWatchListSelected"  class="box-toolbar-separator"></div>

      <div *ngIf="isDesktop() && !isGlobalPredefinedWatchListSelected" class="box-toolbar-child">
        <marketwatch-filter-selector [filter]="filter" (outputFilter)="onSelectingFilter($event)"></marketwatch-filter-selector>
      </div>

        <div *ngIf="isMobile()"  class="box-toolbar-separator"></div>

        <div *ngIf="isMobile()" class="toolbar-button">
        <div class="toolbar-icon columns-icon" (click)="onGridColumnProperties()">الاعمدة</div>
      </div>

      <div class="box-toolbar-separator"></div>
      <div class="box-toolbar-child fill">
<!--        <symbol-selector (outputSymbol)="onSelectingSymbol($event)" [placeHolderText]="getSymbolSelectorPlaceHolderText()"></symbol-selector>-->
      </div>

    </div>

    <div *ngIf="isVisitor()" class="box-toolbar iphone-allow-scrolling" [style.height]="toolbarHeight">
      <div class="box-toolbar-child">
        <watchlist-selector [watchlist]="watchlist" (outputWatchlist)="onSelectingWatchlist($event)"></watchlist-selector>
      </div>
      <div *ngIf="isMobile()" class="toolbar-button">
        <div class="toolbar-icon columns-icon" (click)="onGridColumnProperties()">الاعمدة</div>
      </div>
      <div class="box-toolbar-separator"></div>
      <div class="box-toolbar-child fill">
<!--        <symbol-selector (outputSymbol)="onSelectingSymbol($event)"></symbol-selector>-->
      </div>
    </div>


  </div>
    <div id="{{id}}" [style.height]="height + 'px'" [style.width]="width + 'px'" class="slick-grid"></div>

    <div  class="dropdown-menu annotation-delayed-tooltip context-menu" context-menu [isHoveredTooltip]="true" [left]="annotationDelayed.left" [top]="annotationDelayed.top">
        <annotation-delayed *ngIf="annotationDelayed.item" [symbol]="getSymbol(annotationDelayed.item.symbol)" [marketName]="getMarket(annotationDelayed.item.symbol)"></annotation-delayed>
    </div>
    <div  class="dropdown-menu upgrade-annotation-tooltip context-menu" context-menu [isHoveredTooltip]="true" [left]="upgradeAnnotation.left" [top]="upgradeAnnotation.top">
<!--        <upgrade-annotation *ngIf="upgradeAnnotation.item"></upgrade-annotation>-->
    </div>

  <ul *ngIf="!isVisitor()" class="dropdown-menu context-menu" context-menu [left]="contextMenu.left" [top]="contextMenu.top" role="menu" aria-labelledby="single-button">
    <li class="menuitem menu-title non-selectable" role="menuitem">
      <div>{{getContextMenuItem()?.name}}</div>
    </li>
    <trading-context-menu [symbol]="getContextMenuItem()?.symbol"></trading-context-menu>
    <box-context-menu (outputBoxType)="openWindow($event)"></box-context-menu>
    <li class="divider dropdown-divider"></li>
    <li class="menuitem add-alert icon" role="menuitem" (click)="onNewAlert()">
      <div i18n="@@marketwatch_addAlert">اضافة تنبيه</div>
        <div *ngIf="!isAuthorizedGridBox(FeatureType.ALERT)" class="unauthorized-lock-icon"></div>
    </li>
    <li class="divider dropdown-divider"></li>
    <li role="menuitem" class="menuitem dropdown-submenu add-company icon" dropdown-submenu-toggle>
      <div i18n="@@marketwatch_addCompanyTo">إضافة شركة إلى</div>
      <ul class="dropdown-menu" role="menu" aria-labelledby="single-button">
        <li *ngFor="let watchlist of getContextMenuWatchlists()" class="menuitem icon" role="menuitem" (click)="onAddingSelectedSymbolToWatchlist(watchlist)">
          <div>{{watchlist.name}}</div>
        </li>
        <li *ngIf="0 < getContextMenuWatchlists().length" class="divider dropdown-divider"></li>
        <li class="menuitem icon" role="menuitem" (click)="onNewWatchlist()">
          <div i18n="@@marketwatch_newWatchlist">لائحة أسهمي جديدة</div>
        </li>
      </ul>
    </li>
    <li class="menuitem remove-company icon" role="menuitem" (click)="onRemoveCompany()">
      <div i18n="@@marketwatch_deleteCompany">حذف شركة</div>
    </li>

    <li *ngIf="isColumnEditingAllowed()" class="divider dropdown-divider"></li>

    <li *ngIf="isColumnEditingAllowed() &&!isGlobalPredefinedWatchListSelected" role="menuitem" class="menuitem dropdown-submenu icon-columns icon" dropdown-submenu-toggle>
      <div i18n="@@marketwatch_iconsColumns">أعمدة الايقونات</div>
      <ul class="dropdown-menu" role="menu" aria-labelledby="single-button">
        <li *ngFor="let icon of iconColumnIds" class="menuitem icon" role="menuitem" [class.tick]="!excludedIconColumns.includes(icon)" (click)="onToggleIconColumn(icon)">
<!--          <div><span i18n="@@marketwatch_showIconColumn"> اظهار </span>&nbsp;{{iconColumns[icon] | translate}}</div>-->
        </li>
      </ul>
    </li>

    <li *ngIf="isColumnEditingAllowed()" class="menuitem column-properties icon" role="menuitem" (click)="onGridColumnProperties()">
      <div i18n="@@main-context-menu_columnSettings">إعدادات الأعمدة</div>
      <div *ngIf="!isAuthorizedGridBox(FeatureType.MARKET_WATCH_COLUMN_SETTINGS)" class="unauthorized-lock-icon"></div>
    </li>

    <li class="divider dropdown-divider"></li>
    <li class="menuitem icon" role="menuitem" (click)="toggleToolbarVisibility()" [class.tick] = "isToolbarShown()">
      <div i18n="@@main-context-menu_showToolbox">اظهار شريط الأدوات</div>
    </li>
  </ul>

  <ul *ngIf="isVisitor()" class="dropdown-menu context-menu" context-menu [left]="contextMenu.left" [top]="contextMenu.top" role="menu" aria-labelledby="single-button">
    <li class="menuitem menu-title non-selectable icon" role="menuitem">
      <div>{{getContextMenuItem()?.name}}</div>
    </li>
    <li role="menuitem" class="menuitem dropdown-submenu add-company icon" dropdown-submenu-toggle>
      <div i18n="@@marketwatch_addCompanyTo">إضافة شركة إلى</div>
      <ul class="dropdown-menu" role="menu" aria-labelledby="single-button">
        <li *ngFor="let watchlist of getContextMenuWatchlists()" class="menuitem icon" role="menuitem" (click)="onAddingSelectedSymbolToWatchlist(watchlist)">
          <div>{{watchlist.name}}</div>
        </li>
        <li *ngIf="0 < getContextMenuWatchlists().length" class="divider dropdown-divider"></li>
        <li class="menuitem icon" role="menuitem" (click)="onNewWatchlist()">
          <div i18n="@@marketwatch_newWatchlist">لائحة أسهمي جديدة</div>
        </li>
      </ul>
    </li>
    <li class="menuitem remove-company icon" role="menuitem" (click)="onRemoveCompany()">
      <div i18n="@@marketwatch_deleteCompany">حذف شركة</div>
    </li>
      <li *ngIf="!isMiniMarketWatch()" class="menuitem column-properties icon" role="menuitem" (click)="onGridColumnProperties()">
          <div i18n="@@main-context-menu_columnSettings">إعدادات الأعمدة</div>
      </li>
    <li class="divider dropdown-divider"></li>
    <li class="menuitem icon" role="menuitem" (click)="toggleToolbarVisibility()" [class.tick] = "isToolbarShown()">
      <div i18n="@@main-context-menu_showToolbox">اظهار شريط الأدوات</div>
    </li>
  </ul>

</div>
